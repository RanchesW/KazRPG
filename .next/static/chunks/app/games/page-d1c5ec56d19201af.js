(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{9154:function(e,t,s){Promise.resolve().then(s.bind(s,2457)),Promise.resolve().then(s.bind(s,66))},9205:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var a=s(2265);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),n=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:u="",children:o,iconNode:x,...m}=e;return(0,a.createElement)("svg",{ref:t,...d,width:r,height:r,stroke:s,strokeWidth:n?24*Number(l)/Number(r):l,className:i("lucide",u),...!o&&!c(m)&&{"aria-hidden":"true"},...m},[...x.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(o)?o:[o]])}),o=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{className:c,...d}=s;return(0,a.createElement)(u,{ref:l,iconNode:t,className:i("lucide-".concat(r(n(e))),"lucide-".concat(e),c),...d})});return s.displayName=n(e),s}},3247:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},2457:function(e,t,s){"use strict";s.d(t,{GameList:function(){return N}});var a=s(7437),r=s(2265),l=s(7648),n=s(9205);let i=(0,n.Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),c=(0,n.Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),d=(0,n.Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),u=(0,n.Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),o=(0,n.Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var x=s(6334),m=s(8711),h=s(3448);function f(e){let{game:t,className:s=""}=e,r=t.maxPlayers-t.currentPlayers,n=0===r;return(0,a.jsx)("div",{className:"card-gradient rounded-xl overflow-hidden hover:border-purple-500/30 transition-all duration-300 shadow-lg hover:shadow-purple-500/10 ".concat(s),children:(0,a.jsxs)("div",{className:"p-6 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsx)(m.C,{variant:"info",className:"text-xs",children:(0,h.x9)(t.gameSystem)}),(0,a.jsx)(m.C,{variant:"BEGINNER_FRIENDLY"===t.difficulty?"success":"EXPERT_ONLY"===t.difficulty?"danger":"warning",className:"text-xs",children:(0,h.mq)(t.difficulty)})]}),(0,a.jsx)("h3",{className:"text-xl font-bold text-white mb-2 line-clamp-2",children:t.title}),(0,a.jsx)("p",{className:"text-gray-400 text-sm mb-4 line-clamp-2",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4 pb-4 border-b border-slate-700/50",children:[(0,a.jsxs)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold",children:[t.gm.firstName.charAt(0),t.gm.lastName.charAt(0)]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"text-white font-medium",children:t.gm.username}),t.gm.isVerified&&(0,a.jsx)(m.C,{variant:"success",className:"text-xs",children:"✓"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(i,{className:"w-3 h-3 text-yellow-400 fill-current"}),(0,a.jsx)("span",{className:"text-yellow-400 text-sm",children:t.gm.rating}),t.gm.city&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"•"}),(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:t.gm.city})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[(0,a.jsx)(c,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:(0,h.p6)(t.startDate)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[(0,a.jsx)(d,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[t.currentPlayers,"/",t.maxPlayers," игроков"]}),r<=2&&r>0&&(0,a.jsxs)(m.C,{variant:"warning",className:"text-xs ml-2",children:["Осталось ",r]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[(0,a.jsx)(u,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:t.isOnline?"Онлайн":t.city||"Не указано"})]})]}),t.tags&&(()=>{try{let e=JSON.parse(t.tags);return e.length>0&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mb-4",children:[e.slice(0,3).map((e,t)=>(0,a.jsx)(m.C,{variant:"default",className:"text-xs",children:e},t)),e.length>3&&(0,a.jsxs)("span",{className:"text-gray-500 text-xs px-2 py-1",children:["+",e.length-3]})]})}catch(e){return null}})(),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-1",children:t.pricePerSession?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o,{className:"w-4 h-4 text-green-400"}),(0,a.jsxs)("span",{className:"text-green-400 font-bold",children:[(0,h.T4)(t.pricePerSession)," ₸"]}),(0,a.jsx)("span",{className:"text-gray-500 text-xs",children:"/сессия"})]}):(0,a.jsx)("span",{className:"text-green-400 font-bold",children:"Бесплатно"})}),(0,a.jsx)(l.default,{href:"/games/".concat(t.id),children:(0,a.jsx)(x.z,{size:"sm",disabled:n,variant:n?"outline":"default",children:n?"Мест нет":"Подробнее"})})]})]})})}function g(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,h.cn)("animate-pulse rounded-md bg-slate-700/50",t),...s})}function p(){return(0,a.jsxs)("div",{className:"card-gradient rounded-xl p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)(g,{className:"h-6 w-20"}),(0,a.jsx)(g,{className:"h-6 w-24"})]}),(0,a.jsx)(g,{className:"h-6 w-3/4"}),(0,a.jsx)(g,{className:"h-4 w-full"}),(0,a.jsx)(g,{className:"h-4 w-2/3"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 py-4 border-t border-slate-700/50",children:[(0,a.jsx)(g,{className:"h-10 w-10 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{className:"h-4 w-24"}),(0,a.jsx)(g,{className:"h-3 w-32"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{className:"h-4 w-48"}),(0,a.jsx)(g,{className:"h-4 w-40"}),(0,a.jsx)(g,{className:"h-4 w-36"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(g,{className:"h-5 w-20"}),(0,a.jsx)(g,{className:"h-8 w-24"})]})]})}function j(e){let{children:t,hasNextPage:s,isFetchingNextPage:l,fetchNextPage:n,loader:i,threshold:c=100}=e,d=(0,r.useRef)(null),u=(0,r.useCallback)(e=>{let[t]=e;t.isIntersecting&&s&&!l&&n()},[s,l,n]);return(0,r.useEffect)(()=>{let e=d.current;if(!e)return;let t=new IntersectionObserver(u,{rootMargin:"".concat(c,"px")});return t.observe(e),()=>t.disconnect()},[u,c]),(0,a.jsxs)(a.Fragment,{children:[t,s&&(0,a.jsx)("div",{ref:d,className:"flex justify-center py-8",children:l?i||(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}):null})]})}var v=s(9376);function N(){let e=(0,v.useSearchParams)(),{data:t,loading:s,error:l,hasNextPage:n,fetchNextPage:i,isFetchingNextPage:c,refresh:d}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,s]=(0,r.useState)([]),[a,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0),[u,o]=(0,r.useState)(1),x=(0,r.useCallback)(async function(t){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l(!0),i(null);try{let r=new URLSearchParams({page:t.toString(),limit:"12",...Object.fromEntries(Object.entries(e).filter(e=>{let[t,s]=e;return void 0!==s}))}),l=await fetch("/api/games?".concat(r));if(!l.ok)throw Error("Failed to fetch games");let n=await l.json();a?s(n.games):s(e=>[...e,...n.games]),d(t<n.pagination.pages),o(t)}catch(e){i(e instanceof Error?e.message:"Unknown error")}finally{l(!1)}},[e]),m=(0,r.useCallback)(()=>{!a&&c&&x(u+1)},[x,u,c,a]),h=(0,r.useCallback)(()=>{o(1),x(1,!0)},[x]);return(0,r.useEffect)(()=>{h()},[h]),{data:t,loading:a,error:n,hasNextPage:c,fetchNextPage:m,refresh:h,isFetchingNextPage:a&&u>1}}((0,r.useMemo)(()=>({city:e.get("city")||void 0,gameSystem:e.get("gameSystem")||void 0,isOnline:"true"===e.get("isOnline")||"false"!==e.get("isOnline")&&void 0,language:e.get("language")||void 0,difficulty:e.get("difficulty")||void 0,search:e.get("search")||void 0}),[e]));return l?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsxs)("p",{className:"text-red-400 mb-4",children:["Ошибка загрузки игр: ",l]}),(0,a.jsx)("button",{onClick:d,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Попробовать снова"})]}):s&&0===t.length?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,t)=>(0,a.jsx)(p,{},t))}):0===t.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-gray-400 text-lg mb-4",children:"Игры не найдены"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Попробуйте изменить фильтры поиска"})]}):(0,a.jsx)(j,{hasNextPage:n,isFetchingNextPage:c,fetchNextPage:i,loader:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:3}).map((e,t)=>(0,a.jsx)(p,{},"loading-".concat(t)))}),children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>(0,a.jsx)(f,{game:e},e.id))})})}},66:function(e,t,s){"use strict";s.d(t,{GameSearch:function(){return h}});var a=s(7437),r=s(2265),l=s(9376),n=s(3247);let i=(0,s(9205).Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var c=s(2827),d=s(6334),u=s(8711);let o=[{value:"DND5E",label:"D&D 5e"},{value:"PATHFINDER2E",label:"Pathfinder 2e"},{value:"CALL_OF_CTHULHU",label:"Зов Ктулху"},{value:"VAMPIRE",label:"Вампир"},{value:"SHADOWRUN",label:"Shadowrun"},{value:"CYBERPUNK",label:"Cyberpunk"},{value:"WARHAMMER40K",label:"Warhammer 40K"},{value:"OTHER",label:"Другие"}],x=["Алматы","Астана","Шымкент","Актобе","Тараз"],m=[{value:"BEGINNER_FRIENDLY",label:"Для новичков"},{value:"INTERMEDIATE",label:"Средний уровень"},{value:"ADVANCED",label:"Продвинутый"},{value:"EXPERT_ONLY",label:"Только эксперты"}];function h(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),[s,h]=(0,r.useState)(!1),[f,g]=(0,r.useState)({search:t.get("search")||"",gameSystem:t.get("gameSystem")||"",city:t.get("city")||"",difficulty:t.get("difficulty")||"",isOnline:t.get("isOnline")||""}),p=()=>{let t=new URLSearchParams;Object.entries(f).forEach(e=>{let[s,a]=e;a&&t.set(s,a)}),e.push("/games?".concat(t.toString()))},j=Object.values(f).filter(Boolean).length-(f.search?1:0);return(0,a.jsxs)("div",{className:"space-y-4 mb-8",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)(c.I,{value:f.search,onChange:e=>g({...f,search:e.target.value}),placeholder:"Поиск игр, мастеров, систем...",className:"pl-10",onKeyDown:e=>"Enter"===e.key&&p()})]}),(0,a.jsx)(d.z,{onClick:p,children:"Найти"}),(0,a.jsxs)(d.z,{variant:"outline",onClick:()=>h(!s),className:"relative",children:[(0,a.jsx)(i,{className:"w-4 h-4 mr-2"}),"Фильтры",j>0&&(0,a.jsx)(u.C,{variant:"info",className:"ml-2 px-1.5 py-0.5 text-xs",children:j})]})]}),s&&(0,a.jsxs)("div",{className:"card-gradient rounded-xl p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Игровая система"}),(0,a.jsxs)("select",{value:f.gameSystem,onChange:e=>g({...f,gameSystem:e.target.value}),className:"w-full rounded-lg border border-slate-600 bg-slate-800 px-3 py-2 text-white",children:[(0,a.jsx)("option",{value:"",children:"Все системы"}),o.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Город"}),(0,a.jsxs)("select",{value:f.city,onChange:e=>g({...f,city:e.target.value}),className:"w-full rounded-lg border border-slate-600 bg-slate-800 px-3 py-2 text-white",children:[(0,a.jsx)("option",{value:"",children:"Все города"}),x.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Сложность"}),(0,a.jsxs)("select",{value:f.difficulty,onChange:e=>g({...f,difficulty:e.target.value}),className:"w-full rounded-lg border border-slate-600 bg-slate-800 px-3 py-2 text-white",children:[(0,a.jsx)("option",{value:"",children:"Любая сложность"}),m.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Формат"}),(0,a.jsxs)("select",{value:f.isOnline,onChange:e=>g({...f,isOnline:e.target.value}),className:"w-full rounded-lg border border-slate-600 bg-slate-800 px-3 py-2 text-white",children:[(0,a.jsx)("option",{value:"",children:"Онлайн и оффлайн"}),(0,a.jsx)("option",{value:"true",children:"Только онлайн"}),(0,a.jsx)("option",{value:"false",children:"Только оффлайн"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,a.jsx)(d.z,{onClick:p,className:"flex-1",children:"Применить фильтры"}),j>0&&(0,a.jsx)(d.z,{variant:"ghost",onClick:()=>{g({search:"",gameSystem:"",city:"",difficulty:"",isOnline:""}),e.push("/games")},children:"Очистить"})]})]})]})}},8711:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var a=s(7437);s(2265);var r=s(3448);function l(e){let{className:t,variant:s="default",...l}=e;return(0,a.jsx)("div",{className:(0,r.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",{default:"bg-slate-700 text-slate-200",success:"bg-green-600 text-green-100",warning:"bg-yellow-600 text-yellow-100",danger:"bg-red-600 text-red-100",info:"bg-blue-600 text-blue-100"}[s],t),...l})}},6334:function(e,t,s){"use strict";s.d(t,{z:function(){return l}});var a=s(7437);s(2265);var r=s(3448);function l(e){let{className:t,variant:s="default",size:l="md",...n}=e;return(0,a.jsx)("button",{className:(0,r.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{default:"bg-purple-600 text-white hover:bg-purple-700 focus:ring-purple-500",outline:"border border-purple-600 text-purple-600 hover:bg-purple-50 focus:ring-purple-500",ghost:"text-purple-600 hover:bg-purple-50 focus:ring-purple-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[s],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-base",lg:"h-12 px-6 text-lg"}[l],t),...n})}},2827:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var a=s(7437),r=s(2265),l=s(3448);let n=r.forwardRef((e,t)=>{let{className:s,label:r,error:n,type:i="text",...c}=e;return(0,a.jsxs)("div",{className:"space-y-1",children:[r&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300",children:r}),(0,a.jsx)("input",{type:i,className:(0,l.cn)("flex h-10 w-full rounded-lg border border-slate-600 bg-slate-800 px-3 py-2 text-white placeholder:text-gray-400 focus:border-purple-500 focus:outline-none focus:ring-1 focus:ring-purple-500 disabled:cursor-not-allowed disabled:opacity-50",n&&"border-red-500 focus:border-red-500 focus:ring-red-500",s),ref:t,...c}),n&&(0,a.jsx)("p",{className:"text-sm text-red-400",children:n})]})});n.displayName="Input"},3448:function(e,t,s){"use strict";s.d(t,{T4:function(){return d},cn:function(){return i},mq:function(){return o},p6:function(){return c},x9:function(){return u}});var a=s(1994),r=s(3335),l=s(5948),n=s(692);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}function c(e){return(0,l.Z)(new Date(e),"d MMMM yyyy, HH:mm",{locale:n.Z})}function d(e){return new Intl.NumberFormat("ru-RU").format(e)}function u(e){return({DND5E:"D&D 5e",PATHFINDER2E:"Pathfinder 2e",CALL_OF_CTHULHU:"Зов Ктулху",VAMPIRE:"Вампир",SHADOWRUN:"Shadowrun",CYBERPUNK:"Cyberpunk",WARHAMMER40K:"Warhammer 40K",OTHER:"Другая система"})[e]||e}function o(e){return({BEGINNER_FRIENDLY:"Для новичков",INTERMEDIATE:"Средний уровень",ADVANCED:"Продвинутый",EXPERT_ONLY:"Только эксперты"})[e]||e}}},function(e){e.O(0,[436,972,971,117,744],function(){return e(e.s=9154)}),_N_E=e.O()}]);